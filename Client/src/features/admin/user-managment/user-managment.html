<div class="h-[75vh] overflow-auto rounded-box border border-e-base-content/5 bg-base-100">
    <table class="table">
        <thead>
            <tr>
                <th>Email</th>
                <th>Active roles</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            @for(user of users(); track $index) {
                <tr>
                    <td>{{user.email}}</td>
                    <td>{{user.roles}}</td>
                    <td>
                        <button class="btn btn-sm btn-primary" (click)="openRolesModal(user)">Edit</button>
                    </td>
                </tr>
            }
        </tbody>
        </table>
</div>
<dialog #rolesModal class="modal">
  <div class="modal-box">
    <h3 class="font-bold text-lg">Edit Roles for {{selectedUser?.email}}</h3>
    <fieldset class="fieldset w-full p-3 bg-base-100 border border-base-300 rounded-box">
        <legend class="fieldset-legend">select Roles</legend>
        @for(role of availableRoles; track $index) {
        <label class="fieldset-label cursor-pointer">
          <input 
          (change)="toggleRole($event,role)"
          type="checkbox"
           [checked]="selectedUser?.roles?.includes(role)" 
           [disabled]="selectedUser?.email==='admin@text.com'&&role==='Admin'"
           class="checkbox checkbox-primary mr-2" />
          {{role}}
        </label>
        }
    </fieldset>
    <div class="modal-action">
        <button (click)="updateRoles()" class="btn btn-primary">Submit</button>
    </div>
  </div>
  <form method="dialog" class="modal-backdrop">
    <button>Close</button>
  </form>
</dialog>